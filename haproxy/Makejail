INCLUDE options/options.makejail
INCLUDE options/volumes.makejail

ARG haproxy_tag=14.1
ARG haproxy_hwaddr="00:50:69:6f:74:72"

FROM --ajspec haproxy/.ajspec --entrypoint gh+shen390s/appjails haproxy:${haproxy_tag}

RAW if [ ! -f /conf/haproxy.conf ]; then
       CMD echo "###> '/conf/haproxy.conf' is not a file or does not exist. <###"
       RAW exit 1
RAW fi

RAW COPY /conf/haproxy.conf /usr/local/etc/haproxy.conf

SYSRC ifconfig_sb_haproxy="ether ${haproxy_hwaddr} up ${haproxy_ip}"
SYSRC haproxy_enable=YES
SERVICE netif restart
SERVICE haproxy start
